<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Lydia Reiter, Spindler Thomas">
<title>Netzwerktechnik Dokumentation</title>
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */

@import url(//fonts.googleapis.com/css?family=Noto+Sans);
@import url(https://cdn.jsdelivr.net/gh/asciidoctor/asciidoctor@2.0/data/stylesheets/asciidoctor-default.css); /* Default asciidoc style framework - important */

/* CUSTOMISATIONS */
/* Change the values in root for quick customisation. If you want even more fine grain... venture further. */
:root{
--maincolor:#282c34;
--primarycolor:#f39c12;
--secondarycolor:#03a9f4;
--tertiarycolor:#4db6ac;
--sidebarbackground:#21252b;
--linkcolor:#f44336;
--linkcoloralternate:#ff9800;
--white:#FFFFFF;
}

/* custom added styles */
.listingblock > .content > pre{
  background: var(--sidebarbackground);
  color: var(--white);
}

/* Text styles */
body{font-family: "Noto Sans",sans-serif;background-color: var(--maincolor);color:var(--white);}

h1{color:var(--primarycolor) !important;font-family:"Noto Sans",sans-serif;}
h2,h3,h4,h5,h6{color:var(--secondarycolor) !important;font-family:"Noto Sans",sans-serif;}
.title{color:var(--white) !important;font-family:"Noto Sans",sans-serif;font-style: normal; font-weight: normal;}
p{font-family: "Noto Sans",sans-serif ! important}
#toc.toc2 a:link{color:var(--linkcolor);}
blockquote{color:var(--tertiarycolor) !important}
.quoteblock{color:var(--white)}
code{color:var(--linkcoloralternate);background-color: var(--sidebarbackground) !important}


/* Table styles */
th{background-color: var(--maincolor);color:var(--white) !important;}
td{background-color: var(--maincolor);color: var(--linkcoloralternate) !important}


#toc.toc2{background-color:var(--sidebarbackground);}
#toctitle{color:var(--white);}

/* Responsiveness fixes */
video {
  max-width: 100%;
}

@media all and (max-width: 600px) {
  table {
    width: 55vw!important;
    font-size: 3vw;
  }
}

.exampleblock > .content {
  background-color: var(--maincolor);
}

a {
  color: var(--secondarycolor);
}

.admonitionblock td.icon .icon-tip::before {
  text-shadow: none;
  color: var(--white);
}
.admonitionblock td.icon .icon-note::before {
  color: var(--tertiarycolor);
}
.admonitionblock td.icon .icon-important::before {
  color: var(--linkcolor);
}
/*.admonitionblock td.icon .icon-caution::before {
  color: var(--linkcoloralternate);
}*/
.admonitionblock td.icon .icon-warning::before {
  color: var(--primarycolor);
}

#preamble > .sectionbody > .paragraph:first-of-type p {
  color: var(--white);
}

.quoteblock blockquote::before {
  color: var(--primarycolor);
}
.quoteblock .attribution cite, .verseblock .attribution cite {
  color: var(--white);
}
.verseblock pre {
  color: var(--white);
}
.quoteblock blockquote, .quoteblock blockquote p {
  color: var(--white);
}

.sidebarblock {
  background: var(--sidebarbackground);
}
.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint {
  background: var(--sidebarbackground);
  color: var(--white);
}

#header .details {
  color: var(--white);
}
#header .details span.email a {
  color: var(--linkcoloralternate);
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Netzwerktechnik Dokumentation</h1>
<div class="details">
<span id="author" class="author">Lydia Reiter, Spindler Thomas</span><br>
<span id="revnumber">version 1.0.0,</span>
<span id="revdate">2022-03-28</span>
<br><span id="revremark">NWT</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a>
<ul class="sectlevel2">
<li><a href="#_ziel">1.1. Ziel</a></li>
<li><a href="#_ip_adressen">1.2. IP-Adressen:</a></li>
<li><a href="#_aufbau_des_netzwerkes">1.3. Aufbau des Netzwerkes:</a></li>
<li><a href="#_ssh">1.4. SSH</a></li>
</ul>
</li>
<li><a href="#_grundausstattung">2. Grundausstattung</a>
<ul class="sectlevel2">
<li><a href="#_ssh_2">2.1. SSH</a></li>
<li><a href="#_ufw">2.2. UFW</a></li>
<li><a href="#_sudo">2.3. Sudo</a></li>
<li><a href="#_unattended_upgrades">2.4. Unattended upgrades:</a></li>
<li><a href="#_user">2.5. User</a></li>
</ul>
</li>
<li><a href="#_router">3. Router</a></li>
<li><a href="#_dns">4. DNS</a></li>
<li><a href="#_webserver">5. Webserver</a></li>
<li><a href="#_lubuntu">6. Lubuntu</a>
<ul class="sectlevel2">
<li><a href="#_rdc">6.1. RDC</a></li>
<li><a href="#_ssh_3">6.2. SSH</a></li>
</ul>
</li>
<li><a href="#_pfsense">7. PFSense</a></li>
<li><a href="#_proxy">8. Proxy</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_overview">1. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ziel">1.1. Ziel</h3>
<div class="paragraph">
<p>Erlernen von Netzwerkaufbau und die Dokumentation des Aufbaus. Auch in der Zukunft werden wir so etwas benötigen. Falls der Fall eintritt, dass wir ein Netzwerk aufbauen und es jemand anderes Warten muss, kann derjenige nicht verstehen, wie das Netzwerk aufgebaut ist.</p>
</div>
<div class="sect3">
<h4 id="_router_aufsetzung">1.1.1. Router Aufsetzung</h4>
<div class="paragraph">
<p>Beim Auszug wird ein neues Netzwerk aufgebaut, um es richtig aufbauen zu können und verstehen was passiert, ist dieses Projekt sehr wichtig.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pfsense_proxy_ufw">1.1.2. PFSense / Proxy / UFW</h4>
<div class="paragraph">
<p>Um Firewalls zu verstehen und um ein Netzwerk sicherzumachen, haben wir drei verschiedene Firewalls eingebaut. PFSense ist eine VM und der Proxy befindet sich in einem Container. UFW ist die interne Firewall, die wir in allen Maschinen außer Router und PFSense verwenden.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ip_adressen">1.2. IP-Adressen:</h3>
<div class="paragraph">
<p>Die IP-Adressen der CT und Vms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Router: 10.9.8.214</p>
</li>
<li>
<p>Router außen: 10.9.8.250</p>
</li>
<li>
<p>Pi-Hole: 10.9.8.209</p>
</li>
<li>
<p>Ngnix: 10.9.8.210</p>
</li>
<li>
<p>Lubuntu: 10.9.8.211</p>
</li>
<li>
<p>Pfsense: 10.9.8.212</p>
</li>
<li>
<p>Proxy: 10.9.8.213</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_aufbau_des_netzwerkes">1.3. Aufbau des Netzwerkes:</h3>
<div class="imageblock">
<div class="content">
<img src="images/TheLastNetwork.png" alt="TheLastNetwork">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ssh">1.4. SSH</h3>
<div class="paragraph">
<p>eine SSH Verbindung sollte jederzeit mit allen der Instanzen möglich sein:</p>
</div>
<div class="paragraph">
<p>Diese läuft bei allen Maschinen auf Port 2022</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ssh root@&lt;IP-ADDR&gt; -p 2022

# Root access wird bald abgeschaltet, daher:

ssh user@&lt;IP_ADDR&gt; -p 2022</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grundausstattung">2. Grundausstattung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Es wurden (bis auf die Lubuntu installation) Debian Container verwendet aus folgenden Gründen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Effizienter als Virtuelle Machienen</p>
</li>
<li>
<p>Bereits Erfahrung im Arbeiten mit Debian</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Diese sind wie folgt hardwaretechnisch ausgestattet:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>2 CPU threads (für Parallelisierung)</p>
</li>
<li>
<p>512 MB Arbeitsspeicher</p>
</li>
<li>
<p>1 - 2 Netzwerkinterfaces</p>
</li>
<li>
<p>8 GB Boot drive</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Jeder der einzelnen virtuellen Maschinen / Container hat eine gewisse Grundausstattung, und dazu gehören:</p>
</div>
<div class="sect2">
<h3 id="_ssh_2">2.1. SSH</h3>
<div class="paragraph">
<p>Eine SSH Verbindung kann jederzeit zu allen Containern und Vms aufgebaut werden. Dies ermöglicht schnelles und effizientes Arbeiten.</p>
</div>
<div class="paragraph">
<p>Installation von SSH:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo apt-get update
sudo apt install &amp;&amp; apt upgrade -y

sudo apt install openssh-server
sudo systemctl enable ssh
sudo systemctl start ssh

vi /etc/ssh/sshd_config</code></pre>
</div>
</div>
<div class="paragraph">
<p>Diese wird dann noch mit passenden Einstellungen konfiguriert.</p>
</div>
<div class="paragraph">
<p>SSH kann allerdings bereits mit der default Configuration funktionieren.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ssh &lt;USERNAME&gt;@&lt;HOST&gt;

# z.B:

ssh test@10.0.0.8 -p 2022</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Derzeit werden die SSH Server auf Port 2022 umgelegt.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Um den Port umzulegen, muss dies auch in systemctl umconfiguriert werden:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">nano /lib/systemd/system/ssh.socket

# Dort die folgende Line Abändern:

ListenStream=22 <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>22 mit neuem Port ersezten!</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Wenn dies nicht erledigt wird, started der ssh Server oft nicht automatisch. Dieser läuft allerdings leider in keinen Fehler, sondern wird einfach als "loaded" angezeigt, was zur Verwirrung führen kann.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ufw">2.2. UFW</h3>
<div class="paragraph">
<p>Alle Ports wurden mithilfe von UFW gesichert und abgedreht. Pings werden zukünftig ebenfalls ausgeschaltet.</p>
</div>
<div class="paragraph">
<p>Die benötigten Ports sind dann allerdings freigegeben, sodass z.B die SSH-Verbindungen funktionieren.</p>
</div>
<div class="paragraph">
<p>Diese können mit folgendem Befehl eingesehen werden:</p>
</div>
<div class="paragraph">
<p>Aufgrund der komplexität der Firewall beim Router musste die Firewall dort aktuell deaktiviert werden. An einer Lösung wird gearbeitet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo ufw status

# ports freigeben:

sudo ufw allow 22<i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Portnummer</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_sudo">2.3. Sudo</h3>
<div class="paragraph">
<p>Da dies mit Debian nicht mehr vorinstalliert ist, wurde dies einfach auf die Container hinzugefügt. Dies vereinfacht das zukünftige Anlegen und Arbeiten mit Benutzer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">apt install sudo</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unattended_upgrades">2.4. Unattended upgrades:</h3>
<div class="paragraph">
<p>Unattended upgrades wurde installiert, dass der Server updates automatisch installiert.</p>
</div>
<div class="paragraph">
<p>Installieren:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo apt install unattended-upgrades apt-listchanges bsd-mailx</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configurieren:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo dpkg-reconfigure -plow unattended-upgrades
# dann auf &quot;yes&quot;

sudo vim /etc/apt/apt.conf.d/50unattended-upgrades

#Unkommentieren von folgenden Lines:

Unattended-Upgrade::Mail &quot;mctom.spdo@gmail.com&quot;;

Unattended-Upgrade::Automatic-Reboot &quot;true&quot;;

# -----

sudo vim /etc/apt/listchanges.conf

#Config:

email_address=mctom.spdo@gmail.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Testen der Configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo unattended-upgrades --dry-run</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user">2.5. User</h3>
<div class="paragraph">
<p>erstellen eines neuen Users:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo adduser user</code></pre>
</div>
</div>
<div class="paragraph">
<p>hinzufügen zur Sudogruppe:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">usermod -aG sudo user</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_router">3. Router</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Am Router CT sind 2 Netzwerkarten angebracht. Jeder der einen Netzwerkkarten befindet sich in einem Netzwerk.</p>
</div>
<div class="paragraph">
<p>Damit der Container zwischen diesen zwei Interfaces routet, muss dieser configure werden:</p>
</div>
<div class="paragraph">
<p>Dazu muss man einfach das folgende File editieren:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">vi /etc/sysctl.conf

net.ipv4.ip_forward = 1 <i class="conum" data-value="1"></i><b>(1)</b>
echo 1 &gt; /proc/sys/net/ipv4/ip_forward <i class="conum" data-value="2"></i><b>(2)</b>
reboot <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Diese Zeile auskommentieren</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Da Debian dies standardmäßig ausgeschalten hat, müssen wir dies einschalten</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Man könnte ebenfalls gewisse Teile reloaden, allerdings ist in diesem Fall ein reboot schneller, ale dies zu recherchieren.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dns">4. DNS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Als DNS wurde PI-hole verwendet.</p>
</div>
<div class="paragraph">
<p>Zum Installieren wurde einfach der die offizielle Dokumentation verwendet:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/pi-hole/pi-hole/#one-step-automated-install">Installation von PI-hole</a></p>
</div>
<div class="paragraph">
<p>Das Passwort für das Webinterface wurde ebenfalls auf das Standartpasswort geändert. Hierfür wurde folgender Befehl verwendet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">pihole -a -p</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_webserver">5. Webserver</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nginx wurde als Webserver verwendet. Derzeit ist dort allerdings nur die Standard webpage gehostet.</p>
</div>
<div class="paragraph">
<p>Eine eigene Seite hat derzeit keine Priorität und wird aktuell nach hinten verschoben.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lubuntu">6. Lubuntu</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Eine VM mit Lubuntu Desktop wurde eingerichtet, und in das Netzwerk eingebunden. Zu dieser kann jederzeit eine SSH oder RDP Verbindung aufgebaut werden</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Der Bildschirmschoner sollte deaktiviert werden, denn dies kann Rechenleistung verschwenden.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_rdc">6.1. RDC</h3>
<div class="paragraph">
<p>Auf Lubuntu wurde eine RDC (Remote Desktop Connection) eingerichtet, sodass hier ebenfalls ein schnelles und einfaches Arbeiten möglich ist.</p>
</div>
<div class="paragraph">
<p>Hierfür wurde XRDP verwendet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo apt install xrdp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dies wurde ebenfalls konfiguriert und eingerichtet.</p>
</div>
<div class="paragraph">
<p>Die remote Verbindung kann dann einfach mit den folgenden Daten aufgebaut werden:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="text">IP: 10.9.8.211
Username: thelast
Password: &lt;PASSWORD&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ssh_3">6.2. SSH</h3>
<div class="paragraph">
<p>Die SSH Verbindung wurde gleich wie bei allen anderen Maschinen eingerichtet.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pfsense">7. PFSense</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Da PFSense ein eigenes ISO benötigt, und dieses nicht einfach auf einem normalen Linux laufen kann, wurde dies beim Prof. Angefragt, da wir dies nicht selbst auf den Server hochladen dürfen.</p>
</div>
<div class="paragraph">
<p>Da das ISO bereits auf dem Server zur verfügung steht, wurde bereits damit begonnen, dieses zu installieren und fertig zu machen. In der nächsten Stunde ist geplant, daran weiterzuarbeiten.</p>
</div>
<div class="paragraph">
<p>Installation:</p>
</div>
<div class="paragraph">
<p>Für die Installation von PFSense werden zwei Netzwerkkarten benötigt, denn eine wird für das normale Netzwerk verwendet und die andere Karte wird für ein internes Vlan verwendet.</p>
</div>
<div class="paragraph">
<p>vtnet0 &#8594; Netzwerkkarte für das externe Netzwerk</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pfsense-1.jpg" alt="pfsense 1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/pfsense-2.jpg" alt="pfsense 2">
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/pfsense-3.jpg" alt="pfsense 3"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_proxy">8. Proxy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Der Proxy CT wurde angelegt und vorbereitet, an einer Proxy installation wird aktuell noch gearbeitet.</p>
</div>
<div class="listingblock">
<div class="title">Installations Schritte</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo apt-get update

sudo apt-get install squid</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Konfiguration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">sudo nano /etc/squid/squid.conf</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Für mehr Information und Konfigurationen</div>
<p><a href="https://phoenixnap.com/kb/setup-install-squid-proxy-server-ubuntu" class="bare">https://phoenixnap.com/kb/setup-install-squid-proxy-server-ubuntu</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.0<br>
Last updated 2022-03-28 08:17:35 +0200
</div>
</div>
</body>
</html>